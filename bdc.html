<!DOCTYPE html>
<html lang="en" class="antialiased">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Blood Donation Community</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="shortcut icon" href="image/blood-drop.png" type="image/x-icon">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" xintegrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2k4t1tqL/wO1g4pDq9n+Ww/7A/l5e/Vq3Lw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Custom scrollbar for better aesthetics */
        body::-webkit-scrollbar {
            width: 12px;
        }

        body::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        body::-webkit-scrollbar-thumb {
            background-color: #ef4444;
            border-radius: 6px;
            border: 3px solid #f1f1f1;
        }

        @keyframes bounce-slow {

            0%,
            100% {
                transform: translateY(0) scale(1);
            }

            50% {
                transform: translateY(-20px) scale(1.05);
            }
        }

        .animate-bounce-slow {
            animation: bounce-slow 4s ease-in-out infinite;
        }

        /* Custom styles for Bootstrap Carousel to match Tailwind theme */
        #recentDonorCarousel .carousel-control-prev-icon,
        #recentDonorCarousel .carousel-control-next-icon {
            background-color: rgba(239, 68, 68, 0.7); /* red-500 with opacity */
            border-radius: 50%;
            padding: 1.5rem; /* Make the background larger */
            background-size: 50% 50%;
        }
        #recentDonorCarousel .carousel-indicators li {
            background-color: #fca5a5; /* red-300 */
        }
        #recentDonorCarousel .carousel-indicators .active {
            background-color: #ef4444; /* red-500 */
        }
    </style>
    <meta name="description" content="Community-driven blood donation platform. Register as a donor, search donors by blood group and location.">
</head>

<body class="bg-gray-50 text-gray-900">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

    <script type="module">
        // Import the functions you need from the SDKs you need
        import {
            initializeApp
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
        import {
            getAnalytics
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-analytics.js";
        import {
            getAuth,
            createUserWithEmailAndPassword,
            signInWithEmailAndPassword,
            signOut,
            onAuthStateChanged,
            sendPasswordResetEmail,
            deleteUser
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
        import {
            getDatabase,
            ref,
            push,
            set,
            onValue,
            remove,
            update,
            query,
            limitToLast
        } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js";

        // Your web app's Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBAxWT9HU2C6OAhre_nUyG8OmOq9yPocVw",
            authDomain: "blood-donation-community-a1eb2.firebaseapp.com",
            databaseURL: "https://blood-donation-community-a1eb2-default-rtdb.firebaseio.com",
            projectId: "blood-donation-community-a1eb2",
            storageBucket: "blood-donation-community-a1eb2.appspot.com",
            messagingSenderId: "668392010451",
            appId: "1:668392010451:web:70e2d1c5e17a37a75dda26",
            measurementId: "G-4GPWV4MG5Q"
        };

        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const analytics = getAnalytics(app);
        const auth = getAuth(app);
        const database = getDatabase(app);

        // ==== UI & Event Handlers ====

        let donorsList = [];
        let eventsList = [];
        let currentUser = null;
        let currentUserRole = 'member';

        // Hardcoded admin email for demonstration. In a production app, this should be handled securely on the server.
        const ADMIN_EMAIL = 'mueidshahriar_cse1616@std.bauet.ac.bd';

        // Function to open a modal
        function openModal(modal) {
            if (!modal) return;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
        }

        // Function to close a modal
        function closeModal(modal) {
            if (!modal) return;
            modal.classList.add('hidden');
            modal.classList.remove('flex');
        }

        // Show message in a modal
        function showModalMessage(modal, message, title) {
            const titleEl = modal.querySelector('h3');
            const messageEl = modal.querySelector('p');
            if (titleEl) titleEl.textContent = title;
            if (messageEl) messageEl.textContent = message;
            openModal(modal);
        }

        // Render donor card for public view (hides contact info)
        function renderDonorCardPublic(d) {
            const lastDate = d.lastDonateDate ? new Date(d.lastDonateDate).toLocaleDateString() : '—';
            const contactElement = d.isPhoneHidden ?
                `<a href="#contact" class="text-red-700 font-semibold no-underline">${d.publicComment || 'Contact to Admin'}</a>` :
                `<div class="flex items-center space-x-1">
                    <svg class="w-4 h-4 mr-1 text-red-500" fill="currentColor" viewBox="0 0 24 24"><path d="M3 5a2 2 0 012-2h2.5a1 1 0 01.95.684l1 3a1 1 0 01-.217.982L7.5 10.5a11 11 0 005 5l2.834-2.834a1 1 0 01.982-.217l3 1A1 1 0 0121 16.5V19a2 2 0 01-2 2H17c-8.284 0-15-6.716-15-15V5z"/></svg>
                    <span class="text-xs text-gray-500">${d.phone}</span>
                </div>`;
            return `
                <div class="bg-white p-4 rounded-lg shadow-sm hover:shadow-md transition-shadow duration-200 flex flex-col sm:flex-row sm:items-center justify-between">
                    <div class="flex-1 min-w-0 mb-2 sm:mb-0">
                        <div class="font-bold text-red-700 truncate">${d.fullName}</div>
                        <div class="text-xs text-gray-600 mt-1">
                            <span class="font-bold">Blood Group:</span> <span>${d.bloodGroup}</span>
                        </div>
                        <div class="text-xs text-gray-600">
                            <span class="font-bold">Current Location:</span> <span>${d.location || '—'}</span>
                        </div>
                    </div>
                    <div class="flex-shrink-0 flex flex-col items-end justify-end text-xs text-gray-500 mt-2 sm:mt-0 whitespace-nowrap">
                        <div class="flex items-center space-x-1">
                            <span class="font-bold">Last Donated:</span>&nbsp;<span>${lastDate}</span>
                        </div>
                        ${contactElement}
                    </div>
                </div>
            `;
        }

        // Render donor card for admin view (shows all info) and admin can edit and delete
        function renderDonorCardAdmin(d) {
            const lastDate = d.lastDonateDate ? new Date(d.lastDonateDate).toLocaleDateString() : '—';
            const phone = d.phone || '—';
            return `
                <div class="bg-white p-4 rounded-lg shadow-sm flex flex-col sm:flex-row sm:items-center justify-between">
                    <div class="flex-1 min-w-0 mb-2 sm:mb-0">
                        <div class="font-bold text-red-700 truncate">${d.fullName}</div>
                        <div class="text-xs text-gray-600 mt-1"><span class="font-bold">ID:</span> <span>${d.id}</span></div>
                        <div class="text-xs text-gray-600"><span class="font-bold">Email:</span> <span>${d.email}</span></div>
                        <div class="text-xs text-gray-600"><span class="font-bold">Blood Group:</span> <span>${d.bloodGroup}</span></div>
                        <div class="text-xs text-gray-600"><span class="font-bold">Location:</span> <span>${d.location || '—'}</span></div>
                        <div class="text-xs text-gray-600"><span class="font-bold">Phone:</span> <span>${phone}</span></div>
                        <div class="text-xs text-gray-600"><span class="font-bold">Last Donated:</span> <span>${lastDate}</span></div>
                    </div>
                    <div class="flex-shrink-0 mt-4 sm:mt-0 flex gap-2">
                        <button data-member-id="${d.id}" class="edit-member-btn px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300">Edit</button>
                        <button data-member-id="${d.id}" class="delete-member-btn px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700">Delete</button>
                    </div>
                </div>
            `;
        }

        // Render search results based on user role
        function renderSearchResults(filteredDonors) {
            const searchResults = document.getElementById('search-results');
            if (!searchResults) return;

            if (filteredDonors.length === 0) {
                searchResults.innerHTML = '<div class="text-gray-500 italic">No donors found matching your criteria.</div>';
            } else {
                const header = `<div class="text-sm text-gray-600 mb-2">Found <span class="font-bold text-red-700">${filteredDonors.length}</span> donor(s)</div>`;
                searchResults.innerHTML = header + filteredDonors.map(renderDonorCardPublic).join('');
            }
        }

        function renderAdminMembersList() {
            const membersListDiv = document.getElementById('admin-members-list');
            if (!membersListDiv) return;
            membersListDiv.innerHTML = donorsList.map(renderDonorCardAdmin).join('');

            // Add event listeners for edit and delete buttons
            membersListDiv.querySelectorAll('.edit-member-btn').forEach(button => {
                button.addEventListener('click', (ev) => {
                    const memberId = ev.target.dataset.memberId;
                    const memberData = donorsList.find(d => d.id === memberId);
                    if (memberData) {
                        // Populate admin member form
                        document.getElementById('admin-member-id').value = memberData.id;
                        document.getElementById('admin-member-fullname').value = memberData.fullName || '';
                        document.getElementById('admin-member-phone').value = memberData.phone || '';
                        document.getElementById('admin-member-bloodGroup').value = memberData.bloodGroup || '';
                        document.getElementById('admin-member-location').value = memberData.location || '';
                        document.getElementById('admin-member-lastDonateDate').value = memberData.lastDonateDate || '';
                        document.getElementById('admin-member-hide-phone').checked = memberData.isPhoneHidden || false;
                        document.getElementById('admin-member-comment').value = memberData.publicComment || '';

                        // Smoothly navigate to the form
                        document.getElementById('admin-member-form').scrollIntoView({
                            behavior: 'smooth'
                        });
                    }
                });
            });

            membersListDiv.querySelectorAll('.delete-member-btn').forEach(button => {
                button.addEventListener('click', (ev) => {
                    const memberId = ev.target.dataset.memberId;
                    const memberData = donorsList.find(d => d.id === memberId);
                    if (memberId && memberData) {
                        deleteMember(memberId);
                    }
                });
            });
        }

        // Render events for admin
        function renderAdminEventsList() {
            const eventsListDiv = document.getElementById('admin-events-list');
            if (!eventsListDiv) return;
            eventsListDiv.innerHTML = eventsList.map(e => `
                <div class="bg-white p-4 rounded-lg shadow-sm flex items-center justify-between">
                    <div class="flex-1 min-w-0">
                        <div class="font-bold text-red-700 truncate">${e.title}</div>
                        <div class="text-sm text-gray-600">${e.date} at ${e.time}</div>
                    </div>
                    <div class="flex-shrink-0 flex gap-2">
                        <button data-event-id="${e.id}" class="edit-event-btn px-3 py-1 text-sm bg-gray-200 rounded hover:bg-gray-300">Edit</button>
                        <button data-event-id="${e.id}" class="delete-event-btn px-3 py-1 text-sm bg-red-600 text-white rounded hover:bg-red-700">Delete</button>
                    </div>
                </div>
            `).join('');

            // Add event listeners for edit and delete buttons
            eventsListDiv.querySelectorAll('.edit-event-btn').forEach(button => {
                button.addEventListener('click', (ev) => {
                    const eventId = ev.target.dataset.eventId;
                    const eventData = eventsList.find(e => e.id === eventId);
                    if (eventData) {
                        document.getElementById('admin-event-id').value = eventData.id;
                        document.getElementById('event-title').value = eventData.title;
                        document.getElementById('event-date').value = eventData.date;
                        document.getElementById('event-time').value = eventData.time;
                        document.getElementById('event-location').value = eventData.location;
                        document.getElementById('event-description').value = eventData.description;
                    }
                });
            });
            eventsListDiv.querySelectorAll('.delete-event-btn').forEach(button => {
                button.addEventListener('click', (ev) => {
                    const eventId = ev.target.dataset.eventId;
                    if (eventId) {
                        deleteEvent(eventId);
                    }
                });
            });
        }

        function clearAdminEventForm() {
            document.getElementById('admin-event-form').reset();
            document.getElementById('admin-event-id').value = '';
        }

        function clearAdminMemberForm() {
            document.getElementById('admin-member-form').reset();
            document.getElementById('admin-member-id').value = '';
        }

        function renderRecentDonorsCarousel(donors) {
            const carouselInner = document.querySelector('#recentDonorCarousel .carousel-inner');
            const carouselIndicators = document.querySelector('#recentDonorCarousel .carousel-indicators');
            if (!carouselInner || !carouselIndicators) return;

            carouselInner.innerHTML = '';
            carouselIndicators.innerHTML = '';

            if (donors.length === 0) {
                carouselInner.innerHTML = '<div class="text-center p-5">No recent donations to show.</div>';
                return;
            }

            donors.forEach((d, index) => {
                const date = d.date ? new Date(d.date).toLocaleDateString() : '—';
                const itemClass = index === 0 ? 'carousel-item active' : 'carousel-item';

                const carouselItemHTML = `
                    <div class="${itemClass}">
                        <div class="relative bg-white p-6 rounded-xl shadow-lg mx-auto max-w-2xl text-center overflow-hidden">
                            <div class="absolute top-0 left-0 h-full w-2 bg-red-600"></div>
                            <div class="absolute top-0 right-0 h-full w-2 bg-red-600"></div>
                            <h3 class="text-xl font-bold text-red-700">Recent Donation</h3>
                            <p class="mt-4 text-gray-700">A huge thank you to our recent donor, <span class="font-bold text-red-600">${d.name}</span>, who donated blood on <span class="font-semibold">${date}</span>.</p>
                            <ul class="mt-4 list-none p-0 space-y-1 text-gray-600">
                                <li><span class="font-bold">Blood Group:</span> ${d.bloodGroup}</li>
                                <li><span class="font-bold">Location:</span> ${d.location}</li>
                            </ul>
                        </div>
                    </div>
                `;
                carouselInner.innerHTML += carouselItemHTML;

                const indicatorClass = index === 0 ? 'active' : '';
                const indicatorHTML = `<li data-target="#recentDonorCarousel" data-slide-to="${index}" class="${indicatorClass}"></li>`;
                carouselIndicators.innerHTML += indicatorHTML;
            });
        }


        // Fetch data from Firebase
        const donorsRef = ref(database, 'donors');
        onValue(donorsRef, (snapshot) => {
            const data = snapshot.val();
            donorsList = [];
            for (let key in data) {
                if (data.hasOwnProperty(key)) {
                    donorsList.push({
                        id: key,
                        ...data[key]
                    });
                }
            }
            const searchForm = document.getElementById('search-form');
            if (searchForm) {
                const blood = document.getElementById('search-blood')?.value?.trim();
                const location = document.getElementById('search-location')?.value?.trim();
                const filtered = donorsList.filter(d =>
                    (!blood || d.bloodGroup === blood) &&
                    (!location || (d.location || '').toLowerCase().includes(location.toLowerCase()))
                );
                renderSearchResults(filtered);
            }
            if (currentUserRole === 'admin') {
                renderAdminMembersList();
            }
            // Update donor count on UI
            const donorCountEl = document.getElementById('donor-count');
            if (donorCountEl) {
                donorCountEl.textContent = donorsList.length;
            }
        }, (error) => {
            console.error("Failed to load donors: ", error);
        });

        const eventsRef = ref(database, 'events');
        onValue(eventsRef, (snapshot) => {
            const data = snapshot.val();
            eventsList = [];
            for (let key in data) {
                if (data.hasOwnProperty(key)) {
                    eventsList.push({
                        id: key,
                        ...data[key]
                    });
                }
            }
            const publicEventsList = document.getElementById('public-events-list');
            if (publicEventsList) {
                publicEventsList.innerHTML = eventsList.map(e => `
                    <article class="bg-white rounded-xl shadow-lg p-4 flex gap-4 items-center flex-col sm:flex-row text-center sm:text-left">
                        <div class="flex-shrink-0 w-full sm:w-20">
                            <div class="text-sm font-bold text-red-700">${e.date.split('-')[1]}</div>
                            <div class="text-2xl font-extrabold">${e.date.split('-')[2]}</div>
                            <div class="text-xs text-gray-500">${e.date.split('-')[0]}</div>
                        </div>
                        <div class="flex-1">
                            <h3 class="text-lg font-bold">${e.title}</h3>
                            <p class="text-sm text-gray-600">${e.location} • ${e.time}</p>
                            <p class="mt-2 text-gray-700">${e.description}</p>
                            <div class="mt-3 flex gap-2 justify-center sm:justify-start">
                                <a href="#" class="px-4 py-2 bg-red-600 text-white rounded-md">Register</a>
                            </div>
                        </div>
                    </article>
                `).join('');
            }
            if (currentUserRole === 'admin') {
                renderAdminEventsList();
            }

            // Update event count on UI
            const eventCountEl = document.getElementById('event-count');
            if (eventCountEl) {
                eventCountEl.textContent = eventsList.length;
            }

        }, (error) => {
            console.error("Failed to load events: ", error);
        });

        // Listen for "Lives Helped" data
        const statsRef = ref(database, 'stats');
        onValue(statsRef, (snapshot) => {
            const statsData = snapshot.val();
            const livesHelpedEl = document.getElementById('lives-helped-count');
            if (livesHelpedEl && statsData && statsData.livesHelped) {
                livesHelpedEl.textContent = statsData.livesHelped;
            }
        }, (error) => {
            console.error("Failed to load stats: ", error);
        });

        // Listen for "Recent Donor" data
        const recentDonationsRef = ref(database, 'recentDonations');
        const recentDonationsQuery = query(recentDonationsRef, limitToLast(3));
        onValue(recentDonationsQuery, (snapshot) => {
            const data = snapshot.val();
            const recentDonors = [];
            if (data) {
                for (const key in data) {
                    recentDonors.push({
                        id: key,
                        ...data[key]
                    });
                }
            }
            renderRecentDonorsCarousel(recentDonors.reverse()); // Reverse to show newest first
        }, (error) => {
            console.error("Failed to load recent donations: ", error);
        });


        // Update UI based on auth state
        function updateLoginButtonState() {
            const loginBtn = document.getElementById('login-btn');
            const mobileLoginBtn = document.getElementById('mobile-login-btn');
            const profileUserId = document.getElementById('profile-userId');
            const adminPanel = document.getElementById('admin-panel');
            if (!loginBtn || !mobileLoginBtn || !adminPanel) return;

            if (currentUser) {
                loginBtn.textContent = 'Profile';
                loginBtn.dataset.state = 'loggedin';
                mobileLoginBtn.textContent = 'Profile';
                if (profileUserId) profileUserId.textContent = `User ID: ${currentUser.uid}`;
                // Check user role
                const userRef = ref(database, `donors/${currentUser.uid}/role`);
                onValue(userRef, (snapshot) => {
                    currentUserRole = snapshot.val() || 'member';
                    if (currentUserRole === 'admin') {
                        adminPanel.classList.remove('hidden');
                        renderAdminMembersList();
                        renderAdminEventsList();
                    } else {
                        adminPanel.classList.add('hidden');
                    }
                }, {
                    onlyOnce: true
                });
            } else {
                loginBtn.textContent = 'Login';
                loginBtn.dataset.state = 'loggedout';
                mobileLoginBtn.textContent = 'Login';
                if (profileUserId) profileUserId.textContent = '';
                adminPanel.classList.add('hidden');
            }
        }

        // Firebase Auth State Listener
        onAuthStateChanged(auth, (user) => {
            currentUser = user;
            updateLoginButtonState();
        });

        // Admin functionality
        function saveEvent(eventData) {
            if (!currentUser || currentUserRole !== 'admin') {
                showModalMessage(successModal, 'You do not have permission to perform this action.', 'Permission Denied');
                return;
            }
            const eventId = eventData.id;
            delete eventData.id;
            if (eventId) {
                update(ref(database, 'events/' + eventId), eventData)
                    .then(() => showModalMessage(successModal, 'Event updated successfully!', 'Success'))
                    .catch(error => showModalMessage(successModal, `Failed to update event: ${error.message}`, 'Error'));
            } else {
                const newEventRef = push(eventsRef);
                set(newEventRef, eventData)
                    .then(() => showModalMessage(successModal, 'New event created successfully!', 'Success'))
                    .catch(error => showModalMessage(successModal, `Failed to create event: ${error.message}`, 'Error'));
            }
            clearAdminEventForm();
        }

        function deleteEvent(eventId) {
            if (!currentUser || currentUserRole !== 'admin') {
                showModalMessage(successModal, 'You do not have permission to perform this action.', 'Permission Denied');
                return;
            }
            if (confirm('Are you sure you want to delete this event?')) {
                remove(ref(database, 'events/' + eventId))
                    .then(() => showModalMessage(successModal, 'Event deleted successfully!', 'Success'))
                    .catch(error => showModalMessage(successModal, `Failed to delete event: ${error.message}`, 'Error'));
            }
        }

        function deleteMember(memberId, memberEmail) {
            if (!currentUser || currentUserRole !== 'admin') {
                showModalMessage(successModal, 'You do not have permission to perform this action.', 'Permission Denied');
                return;
            }
            if (confirm(`Are you sure you want to delete member with ID: ${memberId}?`)) {
                remove(ref(database, 'donors/' + memberId))
                    .then(() => showModalMessage(successModal, 'Member profile deleted successfully!', 'Success'))
                    .catch(error => showModalMessage(successModal, `Failed to delete member data: ${error.message}`, 'Error'));
            }
        }

        window.onload = function() {
            const successModal = document.getElementById('success-modal');
            const successClose = document.getElementById('success-close');
            successClose?.addEventListener('click', () => closeModal(successModal));
            successModal?.querySelector('.absolute.inset-0')?.addEventListener('click', () => closeModal(successModal));

            const loginModal = document.getElementById('login-modal');
            const loginCancel = document.getElementById('login-cancel');
            loginCancel?.addEventListener('click', () => closeModal(loginModal));
            loginModal?.querySelector('.absolute.inset-0')?.addEventListener('click', () => closeModal(loginModal));

            const profileModal = document.getElementById('profile-modal');
            const pfClose = document.getElementById('pf-close');
            const pfLogout = document.getElementById('pf-logout');
            const pfDelete = document.getElementById('pf-delete');
            const profileForm = document.getElementById('profile-form');
            const deleteConfirmModal = document.getElementById('delete-confirm-modal');
            const deleteCancelBtn = document.getElementById('delete-cancel');
            const deleteConfirmBtn = document.getElementById('delete-confirm');

            deleteCancelBtn?.addEventListener('click', () => closeModal(deleteConfirmModal));
            deleteConfirmModal?.querySelector('.absolute.inset-0')?.addEventListener('click', () => closeModal(deleteConfirmModal));

            pfClose?.addEventListener('click', () => closeModal(profileModal));
            profileModal?.querySelector('.absolute.inset-0')?.addEventListener('click', () => closeModal(profileModal));

            const menuToggle = document.getElementById('menu-toggle');
            const mobileMenu = document.getElementById('mobile-menu');
            menuToggle?.addEventListener('click', (ev) => {
                if (!mobileMenu) return;
                mobileMenu.classList.toggle('hidden');
                ev.stopPropagation();
            });

            mobileMenu?.querySelectorAll('a, button').forEach(a => {
                a.addEventListener('click', () => {
                    closeModal(mobileMenu);
                });
            });

            document.addEventListener('click', (e) => {
                if (!mobileMenu) return;
                const isOpen = !mobileMenu.classList.contains('hidden');
                const clickedInside = mobileMenu.contains(e.target) || menuToggle.contains(e.target);
                if (isOpen && !clickedInside) {
                    closeModal(mobileMenu);
                }
            });

            const joinForm = document.getElementById('join-form');
            const joinClear = document.getElementById('join-clear');

            joinForm?.addEventListener('submit', (e) => {
                e.preventDefault();
                const fd = new FormData(joinForm);
                const email = fd.get('email')?.toString().trim();
                const password = fd.get('password')?.toString();
                const confirm = fd.get('confirmPassword')?.toString();
                const gender = fd.get('gender')?.toString();
                const isPhoneHidden = gender === 'Female';
                const donorData = {
                    fullName: fd.get('fullName')?.toString().trim(),
                    phone: fd.get('phone')?.toString().trim(),
                    bloodGroup: fd.get('bloodGroup')?.toString().trim(),
                    location: fd.get('location')?.toString().trim(),
                    lastDonateDate: fd.get('lastDonateDate')?.toString() || '',
                    role: email === ADMIN_EMAIL ? 'admin' : 'member',
                    gender: gender || 'Other',
                    isPhoneHidden: isPhoneHidden
                };

                if (!donorData.fullName || !email || !donorData.phone || !donorData.bloodGroup || !donorData.location || !password || !confirm) {
                    showModalMessage(successModal, 'Please fill all required fields.', 'Error');
                    return;
                }

                if (password.length < 6) {
                    showModalMessage(successModal, 'Password must be at least 6 characters.', 'Error');
                    return;
                }
                if (password !== confirm) {
                    showModalMessage(successModal, 'Passwords do not match.', 'Error');
                    return;
                }

                createUserWithEmailAndPassword(auth, email, password)
                    .then((userCredential) => {
                        const user = userCredential.user;
                        const donorRef = ref(database, 'donors/' + user.uid);
                        set(donorRef, {
                            ...donorData,
                            email: email,
                            createdAt: new Date().toISOString()
                        }).then(() => {
                            showModalMessage(successModal, `Welcome, ${donorData.fullName}! Your donor profile was created successfully.`, 'Success');
                            joinForm.reset();
                        }).catch((error) => {
                            console.error("Error saving donor data:", error);
                            showModalMessage(successModal, 'An error occurred while saving your profile data.', 'Error');
                        });
                    })
                    .catch((error) => {
                        const errorMessage = error.message;
                        showModalMessage(successModal, `Signup failed: ${errorMessage}`, 'Error');
                    });
            });

            joinClear?.addEventListener('click', () => {
                joinForm.reset();
            });

            const searchForm = document.getElementById('search-form');
            const searchBlood = document.getElementById('search-blood');
            const eligibleOnlyCheckbox = document.getElementById('eligible-only');
            const searchResults = document.getElementById('search-results');

            function isDonorEligible(lastDonationDate) {
                if (!lastDonationDate) {
                    return true;
                }
                const today = new Date();
                const lastDonation = new Date(lastDonationDate);
                const threeMonthsAgo = new Date(new Date().setMonth(today.getMonth() - 3));
                return lastDonation <= threeMonthsAgo;
            }

            searchForm?.addEventListener('submit', (e) => {
                e.preventDefault();
                const blood = searchBlood?.value?.trim();
                const showEligibleOnly = eligibleOnlyCheckbox?.checked;

                if (!searchResults) return;
                searchResults.innerHTML = '<div class="text-gray-500 italic">Searching…</div>';

                onValue(donorsRef, (snapshot) => {
                    const data = snapshot.val();
                    let filteredDonors = [];
                    for (let key in data) {
                        if (data.hasOwnProperty(key)) {
                            const donor = {
                                id: key,
                                ...data[key]
                            };
                            if (showEligibleOnly && !isDonorEligible(donor.lastDonateDate)) {
                                continue;
                            }
                            if (!blood || donor.bloodGroup === blood) {
                                filteredDonors.push(donor);
                            }
                        }
                    }
                    renderSearchResults(filteredDonors);
                }, {
                    onlyOnce: true
                });
            });

            const loginBtn = document.getElementById('login-btn');
            const mobileLoginBtn = document.getElementById('mobile-login-btn');
            const loginForm = document.getElementById('login-form');

            function handleLoginClick() {
                if (currentUser) {
                    const userRef = ref(database, `donors/${currentUser.uid}`);
                    onValue(userRef, (snapshot) => {
                        const userData = snapshot.val();
                        if (profileModal && userData) {
                            document.getElementById('profile-fullName').value = userData.fullName || '';
                            document.getElementById('profile-email').value = userData.email || '';
                            document.getElementById('profile-phone').value = userData.phone || '';
                            document.getElementById('profile-bloodGroup').value = userData.bloodGroup || '';
                            document.getElementById('profile-location').value = userData.location || '';
                            document.getElementById('profile-lastDonateDate').value = userData.lastDonateDate || '';
                            document.getElementById('profile-notes').value = userData.notes || '';
                            document.getElementById('profile-role').value = userData.role || 'member';

                            openModal(profileModal);
                        }
                    }, {
                        onlyOnce: true
                    });
                } else {
                    openModal(loginModal);
                }
            }

            loginBtn?.addEventListener('click', handleLoginClick);
            mobileLoginBtn?.addEventListener('click', () => {
                closeModal(mobileMenu);
                handleLoginClick();
            });

            loginForm?.addEventListener('submit', (ev) => {
                ev.preventDefault();
                const email = document.getElementById('login-email')?.value?.trim();
                const password = document.getElementById('login-password')?.value;

                signInWithEmailAndPassword(auth, email, password)
                    .then((userCredential) => {
                        closeModal(loginModal);
                        handleLoginClick();
                    })
                    .catch((error) => {
                        const errorMessage = error.message;
                        showModalMessage(successModal, `Login failed: ${errorMessage}`, 'Login Failed');
                    });
            });

            const forgotPasswordLink = document.getElementById('forgot-password-link');
            forgotPasswordLink?.addEventListener('click', (ev) => {
                ev.preventDefault();
                const emailInput = document.getElementById('login-email');
                const email = emailInput?.value?.trim();
                if (!email) {
                    showModalMessage(successModal, 'Please enter your email to reset the password.', 'Email Required');
                    return;
                }
                sendPasswordResetEmail(auth, email)
                    .then(() => {
                        showModalMessage(successModal, `A password reset link has been sent to ${email}. Please check your inbox.`, 'Password Reset Sent');
                        closeModal(loginModal);
                    })
                    .catch((error) => {
                        const errorMessage = error.message;
                        showModalMessage(successModal, `Failed to send reset email: ${errorMessage}. Please try again later.`, 'Password Reset Error');
                    });
            });

            const adminEventForm = document.getElementById('admin-event-form');
            if (adminEventForm) {
                adminEventForm.addEventListener('submit', (ev) => {
                    ev.preventDefault();
                    const fd = new FormData(adminEventForm);
                    const eventData = {
                        title: fd.get('title'),
                        date: fd.get('date'),
                        time: fd.get('time'),
                        location: fd.get('location'),
                        description: fd.get('description'),
                        id: fd.get('id')
                    };
                    saveEvent(eventData);
                });
            }

            const clearEventBtn = document.getElementById('clear-event-btn');
            if (clearEventBtn) {
                clearEventBtn.addEventListener('click', clearAdminEventForm);
            }

            const adminRecentDonorForm = document.getElementById('admin-recent-donor-form');
            if (adminRecentDonorForm) {
                adminRecentDonorForm.addEventListener('submit', (ev) => {
                    ev.preventDefault();
                    const fd = new FormData(adminRecentDonorForm);
                    const donorData = {
                        name: fd.get('donor-name'),
                        bloodGroup: fd.get('donor-blood-group'),
                        location: fd.get('donor-location'),
                        date: fd.get('donation-date')
                    };

                    if (!donorData.name || !donorData.bloodGroup || !donorData.location || !donorData.date) {
                        showModalMessage(successModal, 'Please fill all required fields for the recent donor.', 'Error');
                        return;
                    }

                    // Fetch the current lives helped count once
                    onValue(statsRef, (snapshot) => {
                        const statsData = snapshot.val();
                        const currentLivesHelped = (statsData && statsData.livesHelped) ? Number(statsData.livesHelped) : 0;
                        const newLivesHelped = currentLivesHelped + 1;

                        // Get a new key for the recent donation
                        const newDonationRef = push(recentDonationsRef);

                        // Prepare a multi-path update
                        const updates = {};
                        updates[`/recentDonations/${newDonationRef.key}`] = donorData;
                        updates['/stats/livesHelped'] = newLivesHelped;

                        // Atomically update both locations
                        update(ref(database), updates)
                            .then(() => {
                                showModalMessage(successModal, 'Recent donor added and lives helped count incremented!', 'Success');
                                adminRecentDonorForm.reset();
                            })
                            .catch(error => showModalMessage(successModal, `Failed to update data: ${error.message}`, 'Error'));

                    }, {
                        onlyOnce: true
                    });
                });
            }


            const adminMemberForm = document.getElementById('admin-member-form');
            if (adminMemberForm) {
                adminMemberForm.addEventListener('submit', (ev) => {
                    ev.preventDefault();
                    const fd = new FormData(adminMemberForm);
                    const memberId = fd.get('id');
                    const updatedData = {
                        fullName: fd.get('fullName'),
                        phone: fd.get('phone'),
                        bloodGroup: fd.get('bloodGroup'),
                        location: fd.get('location'),
                        lastDonateDate: fd.get('lastDonateDate'),
                        isPhoneHidden: fd.get('isPhoneHidden') === 'on',
                        publicComment: fd.get('publicComment')
                    };
                    if (memberId) {
                        update(ref(database, 'donors/' + memberId), updatedData)
                            .then(() => {
                                showModalMessage(successModal, 'Member profile updated successfully!', 'Success');
                                clearAdminMemberForm();
                            })
                            .catch(error => showModalMessage(successModal, `Failed to update member: ${error.message}`, 'Error'));
                    }
                });
            }

            const clearMemberBtn = document.getElementById('clear-member-btn');
            if (clearMemberBtn) {
                clearMemberBtn.addEventListener('click', clearAdminMemberForm);
            }

            profileForm?.addEventListener('submit', (e) => {
                e.preventDefault();
                if (!currentUser) return;

                const fd = new FormData(profileForm);
                const updatedData = {
                    fullName: fd.get('fullName')?.toString().trim(),
                    phone: fd.get('phone')?.toString().trim(),
                    bloodGroup: fd.get('bloodGroup')?.toString().trim(),
                    location: fd.get('location')?.toString().trim(),
                    lastDonateDate: fd.get('lastDonateDate')?.toString() || '',
                    notes: fd.get('notes')?.toString() || '',
                    email: currentUser.email,
                    role: fd.get('role')?.toString().trim() // Admin can change roles here, but security rules prevent this for members
                };

                const userRef = ref(database, 'donors/' + currentUser.uid);
                set(userRef, updatedData)
                    .then(() => {
                        showModalMessage(successModal, 'Your profile has been updated successfully!', 'Success');
                        closeModal(profileModal);
                    })
                    .catch((error) => {
                        console.error("Error updating profile:", error);
                        showModalMessage(successModal, `Failed to update profile: ${error.message}`, 'Error');
                    });
            });

            pfLogout?.addEventListener('click', () => {
                signOut(auth).then(() => {
                    closeModal(profileModal);
                    showModalMessage(successModal, 'You have been logged out successfully.', 'Logout Successful');
                }).catch((error) => {
                    console.error("Logout failed:", error);
                    showModalMessage(successModal, 'An error occurred during logout.', 'Logout Failed');
                });
            });

            pfDelete?.addEventListener('click', () => {
                if (!currentUser) {
                    showModalMessage(successModal, 'You must be logged in to delete your profile.', 'Error');
                    return;
                }
                openModal(deleteConfirmModal);
            });

            deleteConfirmBtn?.addEventListener('click', () => {
                const user = auth.currentUser;
                const donorRef = ref(database, 'donors/' + user.uid);

                // An admin can delete their own account from the profile modal, but cannot delete others
                // This is a security feature of Firebase Auth
                if (user && user.uid === user.uid) {
                    remove(donorRef)
                        .then(() => {
                            return deleteUser(user);
                        })
                        .then(() => {
                            closeModal(deleteConfirmModal);
                            closeModal(profileModal);
                            showModalMessage(successModal, 'Your profile has been deleted successfully.', 'Profile Deleted');
                        })
                        .catch((error) => {
                            if (error.code === 'auth/requires-recent-login') {
                                showModalMessage(successModal, 'Please log in again to delete your profile.', 'Re-login Required');
                                signOut(auth);
                            } else {
                                console.error("Error deleting profile:", error);
                                showModalMessage(successModal, `Failed to delete profile: ${error.message}`, 'Error');
                            }
                        });
                } else {
                    showModalMessage(successModal, 'You do not have permission to delete this account.', 'Permission Denied');
                }
            });

            document.addEventListener('keydown', (ev) => {
                if (ev.key === 'Escape') {
                    [successModal, profileModal, loginModal, deleteConfirmModal].forEach(m => closeModal(m));
                }
            });
        };
    </script>

    <header class="sticky top-0 z-40 bg-white/90 backdrop-blur shadow-lg rounded-b-xl">
        <nav class="max-w-6xl mx-auto flex items-center justify-between px-4 py-2">
            <div class="flex items-center gap-3">
                <img src="image/blood-drop.png" alt="logo" class="h-10 w-10 rounded-full border-2 border-red-600 shadow" />
                <span class="text-2xl font-extrabold text-red-700 tracking-tight">Blood Donation Community</span>
            </div>
            <div class="hidden md:flex items-center gap-4 text-base font-medium">
                <a href="#about" class="px-3 py-2 rounded hover:bg-red-50 text-red-700">About</a>
                <a href="#how" class="px-3 py-2 rounded hover:bg-red-50 text-red-700">How to Donate</a>
                <a href="#events" class="px-3 py-2 rounded hover:bg-red-50 text-red-700">Events</a>
                <a href="#join" class="px-3 py-2 rounded hover:bg-red-50 text-red-700">Join</a>
                <a href="#search" class="px-3 py-2 rounded hover:bg-red-50 text-red-700">Search</a>
                <a href="#contact" class="px-3 py-2 rounded hover:bg-red-50 text-red-700">Contact</a>
            </div>
            <div class="flex items-center gap-2">
                <button id="login-btn" class="hidden md:inline-block bg-red-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-red-700 transition">Login</button>
                <button id="menu-toggle" class="md:hidden p-2 rounded-lg bg-red-100 text-red-700 hover:bg-red-200" aria-label="Open menu">
                    <svg class="w-7 h-7" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
            </div>
        </nav>
        <div id="mobile-menu" class="md:hidden hidden bg-white/95 shadow-lg rounded-b-xl">
            <div class="px-4 py-4 flex flex-col gap-2 text-red-700">
                <a href="#about" class="block px-3 py-2 rounded hover:bg-red-50">About</a>
                <a href="#how" class="block px-3 py-2 rounded hover:bg-red-50">How to Donate</a>
                <a href="#events" class="block px-3 py-2 rounded hover:bg-red-50">Events</a>
                <a href="#join" class="block px-3 py-2 rounded hover:bg-red-50">Join</a>
                <a href="#search" class="block px-3 py-2 rounded hover:bg-red-50">Search</a>
                <button id="mobile-login-btn" class="w-full text-left px-3 py-2 rounded hover:bg-red-50 text-red-700 font-medium">Login</button>
            </div>
        </div>
    </header>

    <main class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <section class="relative flex flex-col md:flex-row items-center justify-between py-20 gap-10">
            <div class="flex-1 flex flex-col items-center justify-center text-center md:items-start md:text-left">
                <h1 class="text-4xl sm:text-5xl font-extrabold text-red-700 mb-4 tracking-tight break-words leading-tight">
                    Donate Blood Save Life
                </h1>
                <p class="mb-8 text-lg text-gray-700 max-w-xl mx-auto md:mx-0">Be a hero in your community. Register as a donor,
                    find blood matches and join our events to help save lives every day.</p>
                <div class="flex flex-col sm:flex-row gap-4 w-full sm:w-auto items-center justify-center md:justify-start">
                    <a href="#join" class="w-full sm:w-auto text-center bg-gradient-to-r from-red-600 to-red-400 text-white px-8 py-3 rounded-lg font-semibold shadow-lg hover:scale-105 transition">Become
                        a Donor</a>
                    <a href="#search" class="w-full sm:w-auto text-center bg-white border-2 border-red-600 text-red-600 px-8 py-3 rounded-lg font-semibold shadow hover:bg-red-50 hover:scale-105 transition">Search
                        Donors</a>
                </div>
            </div>
            <div class="flex-1 flex justify-center items-center">
                <div class="relative">
                    <img src="image/blood-drop.png" alt="blood drop" class="w-56 h-56 object-contain drop-shadow-xl animate-bounce-slow" />
                    <div class="absolute bottom-0 left-1/2 -translate-x-1/2 w-40 h-8 bg-red-200 rounded-full blur-xl opacity-60">
                    </div>
                </div>
            </div>
        </section>

        <section id="recent-donor" class="py-12">
            <div id="recentDonorCarousel" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                    <!-- Indicators will be generated here -->
                </ol>
                <div class="carousel-inner">
                    <!-- Carousel items will be generated here -->
                </div>
                <a class="carousel-control-prev" href="#recentDonorCarousel" role="button" data-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#recentDonorCarousel" role="button" data-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="sr-only">Next</span>
                </a>
            </div>
        </section>

        <section id="about" class="py-12">
            <div class="bg-white rounded-xl shadow-lg p-8 border-l-8 border-red-600 flex flex-col md:flex-row gap-8 items-start">
                <div class="flex-shrink-0 flex items-center justify-center w-20 h-20 bg-red-100 rounded-full shadow">
                    <svg class="w-12 h-12 text-red-600" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 2C12 2 7 8.5 7 12a5 5 0 0010 0c0-3.5-5-10-5-10z" />
                    </svg>
                </div>
                <div class="flex-1">
                    <h2 class="text-3xl font-extrabold text-red-700 mb-2 tracking-tight flex items-center gap-2">
                        About Us
                        <span class="inline-block bg-red-600 text-white text-xs font-bold px-2 py-1 rounded">Community</span>
                    </h2>
                    <p class="text-justify">
                        <span class="font-semibold text-red-700">Blood Donation Community</span> is a passionate, volunteer-driven
                        organization dedicated to saving lives through the power of blood donation. We connect willing donors with
                        patients in urgent need, organize regular blood drives and partner with hospitals and local groups to ensure
                        a safe and reliable blood supply for all.
                    </p>
                    <ul class="mt-6 list-disc pl-6 text-gray-700 space-y-2">
                        <li><span class="font-bold text-red-700">Our Mission:</span> To eliminate blood shortages and make
                            lifesaving blood accessible to everyone, everywhere.</li>
                        <li><span class="font-bold text-red-700">What We Do:</span> Host donation events, maintain a donor registry,
                            provide emergency matching and raise awareness about the importance of regular blood donation.</li>
                        <li><span class="font-bold text-red-700">Community Impact:</span> Hundreds of lives saved each year through
                            our network of donors and volunteers. We support hospitals, disaster relief and urgent medical cases.</li>
                        <li><span class="font-bold text-red-700">Get Involved:</span> Anyone can join as a donor, volunteer or
                            supporter. Together, we build a caring, responsive community that puts compassion into action.</li>
                    </ul>
                    <p class="mt-6 text-gray-700 text-base">
                        <span class="font-semibold text-red-700">Join us to make a difference</span> - your single donation can save
                        up to three lives. Stay connected for upcoming events, success stories and ways to help.
                    </p>
                </div>
            </div>
        </section>

        <section id="how" class="py-12">
            <div class="grid md:grid-cols-3 gap-6">
                <article class="bg-white rounded-xl shadow-lg p-6 hover:scale-105 transform transition">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center text-red-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 11c1.657 0 3-1.343 3-3S13.657 5 12 5s-3 1.343-3 3 1.343 3 3 3zM19 21v-2a4 4 0 00-4-4H9a4 4 0 00-4 4v2" />
                            </svg>
                        </div>
                        <h4 class="text-lg font-bold text-red-700">Check Eligibility</h4>
                    </div>
                    <p class="mt-4 text-gray-600">Before donating, please ensure you meet the basic eligibility criteria: age,
                        health condition and travel/medication restrictions. We provide guidelines and a brief self-check.</p>
                    <a href="#" class="mt-4 inline-block text-sm text-red-600 font-medium hover:underline">Learn more →</a>
                </article>

                <article class="bg-white rounded-xl shadow-lg p-6 hover:scale-105 transform transition">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center text-red-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7V3m8 4V3M3 11h18M5 21h14a2 2 0 002-2V7H3v12a2 2 0 002 2z" />
                            </svg>
                        </div>
                        <h4 class="text-lg font-bold text-red-700">Register</h4>
                    </div>
                    <p class="mt-4 text-gray-600">Sign up quickly using our form. You can register as a donor and optionally
                        create an account to manage your profile and donation history.</p>
                    <a href="#join" class="mt-4 inline-block text-sm text-red-600 font-medium hover:underline">Register now →</a>
                </article>

                <article class="bg-white rounded-xl shadow-lg p-6 hover:scale-105 transform transition">
                    <div class="flex items-center gap-4">
                        <div class="w-12 h-12 rounded-full bg-red-100 flex items-center justify-center text-red-600">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4" />
                            </svg>
                        </div>
                        <h4 class="text-lg font-bold text-red-700">Donate & Save</h4>
                    </div>
                    <p class="mt-4 text-gray-600">Find the nearest blood drive or visit a partner blood bank. Our events are run
                        by certified teams ensuring donor safety and comfort.</p>
                    <a href="#events" class="mt-4 inline-block text-sm text-red-600 font-medium hover:underline">See events →</a>
                </article>
            </div>

            <div class="mt-8 bg-white rounded-lg shadow p-6 flex flex-col md:flex-row items-center justify-between gap-6">
                <div class="flex flex-col sm:flex-row items-center gap-6 w-full md:w-auto">
                    <div class="text-center">
                        <div id="donor-count" class="text-3xl font-extrabold text-red-700">0</div>
                        <div class="text-sm text-gray-600">Registered Donors</div>
                    </div>
                    <div class="text-center">
                        <div id="lives-helped-count" class="text-3xl font-extrabold text-red-700">0</div>
                        <div class="text-sm text-gray-600">Lives Helped</div>
                    </div>
                    <div class="text-center">
                        <div id="event-count" class="text-3xl font-extrabold text-red-700">0</div>
                        <div class="text-sm text-gray-600">Events This Year</div>
                    </div>
                </div>
                <div class="w-full md:w-auto">
                    <a href="#join" class="w-full text-center inline-block bg-red-600 text-white px-5 py-2 rounded-md font-semibold">Join Our
                        Donor Network</a>
                </div>
            </div>
        </section>

        <section id="events" class="py-12">
            <h2 class="text-2xl font-extrabold text-red-700">Upcoming Events</h2>
            <p class="mt-2 text-gray-600">Join our community drives and help save lives - see the event details and register
                to participate.</p>
            <div id="public-events-list" class="mt-6 grid md:grid-cols-2 gap-6">
                <!-- Events will be dynamically loaded here from the database -->
            </div>
        </section>

        <section id="search" class="py-12">
            <div class="bg-gradient-to-r from-red-50 to-white p-6 rounded-xl shadow-lg">
                <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
                    <div>
                        <h2 class="text-2xl font-extrabold text-red-700">Find Donors</h2>
                        <p class="mt-1 text-sm text-gray-600 max-w-xl">Search by blood group and location to find nearby donors
                            quickly. Connect directly once you locate a match.</p>
                    </div>
                    <div class="w-full md:w-auto flex flex-col items-center gap-4 bg-white p-4 rounded-xl shadow-lg">
                        <form id="search-form" class="flex flex-col sm:flex-row items-center gap-3 w-full">
                            <select id="search-blood" aria-label="Blood group" class="w-full sm:w-50 h-10 px-4 rounded-lg border border-gray-100 bg-white text-gray-700">
                                <option value="">All Donor(s)</option>
                                <option>A+</option>
                                <option>A-</option>
                                <option>B+</option>
                                <option>B-</option>
                                <option>O+</option>
                                <option>O-</option>
                                <option>AB+</option>
                                <option>AB-</option>
                            </select>

                            <button type="submit" class="w-full sm:w-auto h-10 px-6 bg-red-600 text-white rounded-lg font-semibold shadow hover:bg-red-700">Search</button>
                        </form>
                        <div class="w-full flex justify-center items-center">
                            <input type="checkbox" id="eligible-only" class="h-4 w-4 text-red-600 border-gray-300 rounded focus:ring-red-500">
                            <label for="eligible-only" class="ml-2 text-sm text-gray-700 font-medium whitespace-nowrap">Show only
                                eligible donors</label>
                        </div>
                    </div>
                </div>
                <div id="search-results" class="mt-6 flex flex-col gap-4">
                    <div class="text-gray-500 italic">No results yet. Perform a search to display donor entries here.</div>
                </div>
            </div>
        </section>

        <section id="join" class="py-12">
            <div class="bg-white rounded-xl shadow-lg p-8 max-w-lg mx-auto">
                <div class="text-center">
                    <h2 class="text-2xl font-extrabold text-red-700">Join us as a donor</h2>
                    <p class="mt-1 text-gray-600">Register to become part of our verified donor network. Add your details and
                        create an account to manage your donations.</p>
                </div>

                <form id="join-form" class="mt-6 grid grid-cols-1 gap-4">
                    <div class="relative">
                        <input name="fullName" id="fullName" type="text" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                        <label for="fullName" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Full
                            name</label>
                    </div>

                    <div class="relative">
                        <input name="email" id="email" type="email" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                        <label for="email" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Email</label>
                    </div>

                    <div class="flex flex-col">
                        <label for="gender" class="text-sm text-gray-600 mb-2">Gender</label>
                        <select name="gender" id="gender" required class="block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none">
                            <option value="">Select gender</option>
                            <option>Male</option>
                            <option>Female</option>
                            <option>Other</option>
                        </select>
                    </div>

                    <div class="relative">
                        <input name="phone" id="phone" type="tel" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                        <label for="phone" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Phone
                            number</label>
                    </div>

                    <div class="flex flex-col">
                        <label for="bloodGroup" class="text-sm text-gray-600 mb-2">Blood group</label>
                        <select name="bloodGroup" id="bloodGroup" required class="block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none">
                            <option value="">Select group</option>
                            <option>A+</option>
                            <option>A-</option>
                            <option>B+</option>
                            <option>B-</option>
                            <option>O+</option>
                            <option>O-</option>
                            <option>AB+</option>
                            <option>AB-</option>
                        </select>
                    </div>

                    <div class="relative">
                        <input name="location" id="location" type="text" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                        <label for="location" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Current
                            Location</label>
                    </div>

                    <div class="relative">
                        <input name="lastDonateDate" id="lastDonateDate" type="date" placeholder=" " class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                        <label for="lastDonateDate" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Last
                            blood donation</label>
                    </div>

                    <div class="relative">
                        <input name="password" id="password" type="password" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                        <label for="password" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Password</label>
                    </div>

                    <div class="relative">
                        <input name="confirmPassword" id="confirmPassword" type="password" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                        <label for="confirmPassword" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Confirm
                            password</label>
                    </div>
                    <div class="flex gap-3">
                        <button id="join-submit" type="submit" class="bg-red-600 text-white px-6 py-3 rounded-lg font-semibold shadow hover:bg-red-700 flex-1 md:flex-none">Register</button>
                        <button id="join-clear" type="button" class="border border-gray-300 px-4 py-3 rounded-lg flex-1 md:flex-none">Clear</button>
                    </div>
                </form>
            </div>
        </section>

        <!-- Admin Panel Section - Initially Hidden -->
        <section id="admin-panel" class="py-12 hidden">
            <h2 class="text-2xl font-extrabold text-red-700">Admin Dashboard</h2>
            <p class="mt-2 text-gray-600">Welcome, Admin! Here you can manage community events, update donor information and add recent donations.</p>

            <div class="mt-6 grid md:grid-cols-2 gap-6">
                <!-- Event Management Panel -->
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold text-red-600 mb-4">Event Details</h3>
                    <form id="admin-event-form" class="grid grid-cols-1 gap-4">
                        <input type="hidden" id="admin-event-id" name="id" />
                        <div class="relative">
                            <input name="title" id="event-title" type="text" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="event-title" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Event Title</label>
                        </div>
                        <div class="relative">
                            <input name="date" id="event-date" type="date" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="event-date" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Event Date</label>
                        </div>
                        <div class="relative">
                            <input name="time" id="event-time" type="time" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="event-time" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Event Time</label>
                        </div>
                        <div class="relative">
                            <input name="location" id="event-location" type="text" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="event-location" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Location</label>
                        </div>
                        <div class="relative">
                            <textarea name="description" id="event-description" placeholder=" " required rows="2" class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none"></textarea>
                            <label for="event-description" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Description</label>
                        </div>
                        <div class="flex gap-3">
                            <button type="submit" class="bg-red-600 text-white px-6 py-3 rounded-lg font-semibold shadow hover:bg-red-700 flex-1">Save Event</button>
                            <button type="button" id="clear-event-btn" class="border border-gray-300 px-4 py-3 rounded-lg flex-1">Clear</button>
                        </div>
                    </form>
                    <div id="admin-events-list" class="mt-6 flex flex-col gap-4">
                        <!-- Events list will be dynamically loaded here -->
                    </div>
                </div>

                <!-- Member Management Panel -->
                <div class="bg-white p-6 rounded-xl shadow-lg">
                    <h3 class="text-xl font-bold text-red-600 mb-4">Recent Donor</h3>
                    <form id="admin-recent-donor-form" class="grid grid-cols-1 gap-4 mb-6">
                        <div class="relative">
                            <input name="donor-name" id="donor-name" type="text" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="donor-name" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Donor Name</label>
                        </div>
                        <div class="flex flex-col">
                            <label for="donor-blood-group" class="text-sm text-gray-600 mb-2">Blood Group</label>
                            <select name="donor-blood-group" id="donor-blood-group" required class="block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none">
                                <option value="">Select group</option>
                                <option>A+</option>
                                <option>A-</option>
                                <option>B+</option>
                                <option>B-</option>
                                <option>O+</option>
                                <option>O-</option>
                                <option>AB+</option>
                                <option>AB-</option>
                            </select>
                        </div>
                        <div class="relative">
                            <input name="donor-location" id="donor-location" type="text" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="donor-location" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Location</label>
                        </div>
                        <div class="relative">
                            <input name="donation-date" id="donation-date" type="date" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="donation-date" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Donation Date</label>
                        </div>
                        <button type="submit" class="bg-red-600 text-white px-6 py-3 rounded-lg font-semibold shadow hover:bg-red-700">Add Last Donor Info</button>
                    </form>
                    <hr class="my-6 border-t-2 border-gray-100" />
                    <h3 class="text-xl font-bold text-red-600 mb-4">Member Management</h3>
                    <form id="admin-member-form" class="grid grid-cols-1 gap-4">
                        <input type="hidden" id="admin-member-id" name="id" />
                        <div class="relative">
                            <input name="fullName" id="admin-member-fullname" type="text" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="admin-member-fullname" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Full name</label>
                        </div>
                        <div class="relative">
                            <input name="phone" id="admin-member-phone" type="tel" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="admin-member-phone" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Phone number</label>
                        </div>
                        <div class="flex items-center gap-2">
                            <input type="checkbox" id="admin-member-hide-phone" name="isPhoneHidden" class="h-4 w-4 text-red-600 border-gray-300 rounded focus:ring-red-500">
                            <label for="admin-member-hide-phone" class="text-sm text-gray-700 font-medium">Hide phone number from public</label>
                        </div>
                        <div class="relative">
                            <textarea name="publicComment" id="admin-member-comment" placeholder="Optional comment for public" rows="2" class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none"></textarea>
                            <label for="admin-member-comment" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Public comment (e.g., "Contact admin")</label>
                        </div>
                        <div class="flex flex-col">
                            <label for="admin-member-bloodGroup" class="text-sm text-gray-600 mb-2">Blood group</label>
                            <select name="bloodGroup" id="admin-member-bloodGroup" required class="block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none">
                                <option value="">Select group</option>
                                <option>A+</option>
                                <option>A-</option>
                                <option>B+</option>
                                <option>B-</option>
                                <option>O+</option>
                                <option>O-</option>
                                <option>AB+</option>
                                <option>AB-</option>
                            </select>
                        </div>
                        <div class="relative">
                            <input name="location" id="admin-member-location" type="text" placeholder=" " required class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="admin-member-location" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Current Location</label>
                        </div>
                        <div class="relative">
                            <input name="lastDonateDate" id="admin-member-lastDonateDate" type="date" placeholder=" " class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="admin-member-lastDonateDate" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Last blood donation</label>
                        </div>
                        <div class="flex gap-3 mt-4">
                            <button type="submit" class="bg-red-600 text-white px-6 py-3 rounded-lg font-semibold shadow hover:bg-red-700 flex-1">Save Changes</button>
                            <button type="button" id="clear-member-btn" class="border border-gray-300 px-4 py-3 rounded-lg flex-1">Clear</button>
                        </div>
                    </form>
                    <div id="admin-members-list" class="mt-6 flex flex-col gap-4">
                        <!-- Member list will be dynamically loaded here -->
                    </div>
                </div>
            </div>
        </section>

        <section id="contact" class="py-12">
            <div class="bg-white p-8 rounded-lg shadow text-center max-w-3xl mx-auto">
                <h2 class="text-2xl font-extrabold text-red-700">Contact</h2>
                <p class="mt-3 text-gray-700">Have questions or want to get involved? Reach out to us.</p>
                <div class="mt-6 flex flex-col sm:flex-row sm:items-center sm:justify-center gap-4">
                    <a href="mailto:bdc@bloodlife.org" class="flex items-center gap-3 px-4 py-3 rounded-md bg-red-50 hover:bg-red-100">
                        <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 12H8m8 0a4 4 0 11-8 0 4 4 0 018 0z" />
                        </svg>
                        <span class="text-sm font-medium text-red-700">bdc@bloodlife.org</span>
                    </a>
                    <a href="tel:+8801712460423" class="flex items-center gap-3 px-4 py-3 rounded-md bg-red-50 hover:bg-red-100">
                        <svg class="w-5 h-5 text-red-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h2.5a1 1 0 01.95.684l1 3a1 1 0 01-.217.982L7.5 10.5a11 11 0 005 5l2.834-2.834a1 1 0 01.982-.217l3 1A1 1 0 0121 16.5V19a2 2 0 01-2 2H17c-8.284 0-15-6.716-15-15V5z" />
                        </svg>
                        <span class="text-sm font-medium text-red-700">+8801712460423</span>
                    </a>
                </div>
                <div class="mt-6">
                    <a href="#join" class="inline-block bg-red-600 text-white px-6 py-3 rounded-md font-semibold">Join as a
                        Donor</a>
                </div>
            </div>
        </section>

    </main>

    <footer class="mt-12 bg-gray-900 text-gray-200 py-6">
        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <br>© 2025 Life is Beautiful 💜</br>
            <div class="flex justify-center gap-4 mt-2">
                <a href="https://github.com/MueidShahriar" target="_blank" rel="noopener noreferrer" class="text-gray-200 hover:text-red-500 transition-colors">
                    <i class="fab fa-github fa-lg"></i>
                </a>
                <a href="https://www.facebook.com/mueid016" target="_blank" rel="noopener noreferrer" class="text-gray-200 hover:text-red-500 transition-colors">
                    <i class="fab fa-facebook fa-lg"></i>
                </a>
            </div>
            <br>Developed by Md. Mueid Shahriar </br>
            CSE, BAUET
        </div>
    </footer>

    <div id="success-modal" class="fixed inset-0 hidden items-center justify-center z-60">
        <div class="absolute inset-0 bg-black opacity-40"></div>
        <div class="bg-white rounded-lg shadow p-6 max-w-md mx-4 z-10">
            <h3 class="text-lg font-bold text-red-700">Success!</h3>
            <p class="mt-2 text-gray-700"></p>
            <div class="mt-4 text-right">
                <button id="success-close" class="px-4 py-2 bg-red-600 text-white rounded">Close</button>
            </div>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="fixed inset-0 hidden items-center justify-center z-50">
        <div class="absolute inset-0 bg-black opacity-40"></div>
        <div class="bg-white rounded-lg shadow p-6 max-w-md mx-4 z-10">
            <h3 class="text-lg font-bold text-red-700">Login</h3>
            <form id="login-form" class="mt-4">
                <div class="mb-3">
                    <label for="login-email" class="block text-sm text-gray-600 mb-1">Email</label>
                    <input id="login-email" type="email" required class="w-full rounded-lg border p-3" />
                </div>
                <div class="mb-3">
                    <label for="login-password" class="block text-sm text-gray-600 mb-1">Password</label>
                    <input id="login-password" type="password" required class="w-full rounded-lg border p-3" />
                </div>
                <div class="flex items-center justify-end gap-4 mt-2">
                    <div class="flex gap-2 items-center">
                        <button type="submit" class="bg-red-600 text-white px-4 py-2 rounded font-semibold shadow hover:bg-red-700 transition">Sign
                            in</button>
                        <button id="login-cancel" type="button" class="border border-gray-300 text-gray-700 px-4 py-2 rounded font-semibold shadow hover:bg-gray-100 transition">Cancel</button>
                    </div>
                </div>
                <a id="forgot-password-link" href="#" class="block text-center mt-2 text-xs text-red-700 hover:underline hover:text-red-900 transition-colors duration-200">
                    Forgot Password?
                </a>
            </form>
        </div>
    </div>

    <!-- Profile Modal -->
    <div id="profile-modal" class="fixed inset-0 hidden items-center justify-center z-50 overflow-y-auto">
        <div class="absolute inset-0 bg-black opacity-40"></div>
        <div class="bg-white rounded-lg shadow-2xl p-6 max-w-xl mx-auto my-8 z-10">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-red-700">My Profile</h3>
                <button id="pf-close" class="text-gray-400 hover:text-gray-600 transition">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            <form id="profile-form" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <!-- Full Name -->
                <div class="relative">
                    <input name="fullName" id="profile-fullName" type="text" placeholder=" " required
                        class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                    <label for="profile-fullName"
                        class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Full
                        name</label>
                        </div>
                        <!-- Email -->
                        <div class="relative">
                            <!-- Input -->
                            <input name="email" id="profile-email" type="email" placeholder=" " required readonly
                                class="peer block w-full rounded-lg border-2 border-gray-100 bg-gray-100 cursor-not-allowed p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                        
                            <!-- Floating Label -->
                            <label for="profile-email" class="absolute left-4 top-3 text-gray-400 transition-all 
                         peer-placeholder-shown:top-3 peer-placeholder-shown:text-base 
                         peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 
                         peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 
                         pointer-events-none bg-gray-100 px-1"> Email (cannot be changed)
                            </label>
                        </div>
                        
                        <!-- Phone -->
                        <div class="relative">
                            <input name="phone" id="profile-phone" type="tel" placeholder=" " required
                                class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                            <label for="profile-phone"
                        class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Phone
                        number</label>
                </div>
                <!-- Blood Group -->
                <div class="flex flex-col">
                    <label for="profile-bloodGroup" class="text-sm text-gray-600 mb-2">Blood group</label>
                    <select name="bloodGroup" id="profile-bloodGroup" required class="block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none">
                        <option value="">Select group</option>
                        <option>A+</option>
                        <option>A-</option>
                        <option>B+</option>
                        <option>B-</option>
                        <option>O+</option>
                        <option>O-</option>
                        <option>AB+</option>
                        <option>AB-</option>
                    </select>
                </div>
                <!-- Location -->
                <div class="relative">
                    <input name="location" id="profile-location" type="text" placeholder=" " required
                        class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                    <label for="profile-location"
                        class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Current
                        Location</label>
                </div>
                <!-- Last Donation Date -->
                <div class="relative">
                    <input name="lastDonateDate" id="profile-lastDonateDate" type="date" placeholder=" "
                        class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                    <label for="profile-lastDonateDate"
                        class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Last
                        blood donation</label>
                </div>
                <!-- Additional Notes -->
                <div class="relative md:col-span-2">
                    <textarea name="notes" id="profile-notes" placeholder=" " rows="2" class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-3 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none"></textarea>
                    <label for="profile-notes" class="absolute left-4 top-3 text-gray-400 transition-all peer-placeholder-shown:top-3 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">Additional
                        Notes</label>
                </div>
                <div class="relative hidden">
                    <input name="role" id="profile-role" type="text" readonly class="peer block w-full rounded-lg border-2 border-gray-100 bg-white p-4 pl-10 text-gray-900 shadow-sm focus:border-red-300 focus:outline-none" />
                    <label for="profile-role" class="absolute left-10 top-4 text-gray-400 transition-all peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-focus:-top-3 peer-focus:text-sm peer-focus:text-red-700 peer-valid:-top-3 peer-valid:text-sm peer-valid:text-red-700 pointer-events-none bg-white px-1">User Role</label>
                </div>
                <div class="flex flex-wrap gap-3 mt-4 md:col-span-2">
                    <button type="submit" class="bg-red-600 text-white px-6 py-3 rounded-lg font-semibold shadow hover:bg-red-700 flex-1">Save
                        Changes</button>
                    <button id="pf-logout" type="button" class="border border-gray-300 px-4 py-3 rounded-lg flex-1">Logout</button>
                    <!-- Delete Profile Button -->
                    <button id="pf-delete" type="button" class="border border-red-300 text-red-600 px-4 py-3 rounded-lg flex-1 hover:bg-red-50">Delete Profile</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="delete-confirm-modal" class="fixed inset-0 hidden items-center justify-center z-50">
        <div class="absolute inset-0 bg-black opacity-40"></div>
        <div class="bg-white rounded-lg shadow-xl p-6 max-w-sm mx-4 z-10 text-center">
            <h3 class="text-xl font-bold text-red-700 mb-2">Are you sure?</h3>
            <p class="text-gray-700">Deleting your profile is permanent and cannot be undone. All your donor information will be removed.</p>
            <div class="mt-6 flex justify-center gap-4">
                <button id="delete-cancel" class="px-5 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50">Cancel</button>
                <button id="delete-confirm" class="px-5 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700">Delete Permanently</button>
            </div>
        </div>
    </div>
</body>

</html>